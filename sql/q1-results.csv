"QUERY PLAN"
"Limit  (cost=58552.84..58552.96 rows=50 width=14) (actual time=801.953..809.428 rows=50 loops=1)"
"  Output: p.product_id, (sum(f.revenue))"
"  Buffers: shared hit=512253"
"  ->  Sort  (cost=58552.84..58563.01 rows=4070 width=14) (actual time=801.950..809.418 rows=50 loops=1)"
"        Output: p.product_id, (sum(f.revenue))"
"        Sort Key: (sum(f.revenue)) DESC"
"        Sort Method: top-N heapsort  Memory: 28kB"
"        Buffers: shared hit=512253"
"        ->  Finalize GroupAggregate  (cost=2604.93..58417.63 rows=4070 width=14) (actual time=252.984..808.460 rows=4070 loops=1)"
"              Output: p.product_id, sum(f.revenue)"
"              Group Key: p.product_id"
"              Buffers: shared hit=512253"
"              ->  Gather Merge  (cost=2604.93..58336.23 rows=8140 width=14) (actual time=252.887..806.664 rows=4316 loops=1)"
"                    Output: p.product_id, (PARTIAL sum(f.revenue))"
"                    Workers Planned: 2"
"                    Workers Launched: 2"
"                    Buffers: shared hit=512253"
"                    ->  Partial GroupAggregate  (cost=1604.91..56396.65 rows=4070 width=14) (actual time=65.154..522.216 rows=1439 loops=3)"
"                          Output: p.product_id, PARTIAL sum(f.revenue)"
"                          Group Key: p.product_id"
"                          Buffers: shared hit=512253"
"                          Worker 0:  actual time=48.001..722.265 rows=2198 loops=1"
"                            Buffers: shared hit=255489"
"                          Worker 1:  actual time=54.940..730.300 rows=2048 loops=1"
"                            Buffers: shared hit=251083"
"                          ->  Merge Join  (cost=1604.91..50843.02 rows=1102586 width=14) (actual time=64.441..405.853 rows=1333375 loops=3)"
"                                Output: p.product_id, f.revenue"
"                                Merge Cond: (f.product_id = p.product_id)"
"                                Buffers: shared hit=512253"
"                                Worker 0:  actual time=47.711..552.037 rows=1991632 loops=1"
"                                  Buffers: shared hit=255489"
"                                Worker 1:  actual time=53.274..555.455 rows=1973958 loops=1"
"                                  Buffers: shared hit=251083"
"                                ->  Parallel Index Scan using idx_fact_product on public.fact_sales f  (cost=0.42..32147.11 rows=221346 width=14) (actual time=0.063..142.904 rows=177075 loops=3)"
"                                      Output: f.invoice_no, f.product_id, f.customer_id, f.date_id, f.quantity, f.unit_price, f.revenue, f.is_return, f.is_free_item"
"                                      Filter: ((f.date_id >= '2010-01-01'::date) AND (f.date_id <= '2011-12-31'::date))"
"                                      Buffers: shared hit=511735"
"                                      Worker 0:  actual time=0.078..211.846 rows=264995 loops=1"
"                                        Buffers: shared hit=255308"
"                                      Worker 1:  actual time=0.079..209.386 rows=260540 loops=1"
"                                        Buffers: shared hit=250902"
"                                ->  Sort  (cost=1604.17..1649.06 rows=17954 width=6) (actual time=64.360..105.553 rows=1343257 loops=3)"
"                                      Output: p.product_id"
"                                      Sort Key: p.product_id"
"                                      Sort Method: quicksort  Memory: 769kB"
"                                      Buffers: shared hit=518"
"                                      Worker 0:  actual time=47.613..108.631 rows=1999298 loops=1"
"                                        Sort Method: quicksort  Memory: 769kB"
"                                        Buffers: shared hit=181"
"                                      Worker 1:  actual time=53.171..113.702 rows=1982053 loops=1"
"                                        Sort Method: quicksort  Memory: 769kB"
"                                        Buffers: shared hit=181"
"                                      ->  Seq Scan on public.dim_products p  (cost=0.00..335.54 rows=17954 width=6) (actual time=0.632..2.854 rows=17954 loops=3)"
"                                            Output: p.product_id"
"                                            Buffers: shared hit=508"
"                                            Worker 0:  actual time=1.043..2.562 rows=17954 loops=1"
"                                              Buffers: shared hit=176"
"                                            Worker 1:  actual time=0.827..3.207 rows=17954 loops=1"
"                                              Buffers: shared hit=176"
"Planning:"
"  Buffers: shared hit=16"
"Planning Time: 1.146 ms"
"Execution Time: 809.669 ms"

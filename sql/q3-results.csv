"QUERY PLAN"
"Limit  (cost=15421.17..15428.93 rows=50 width=26) (actual time=172.523..180.172 rows=50 loops=1)"
"  Output: d.year, c.country, (sum(f.revenue))"
"  Buffers: shared hit=6260"
"  ->  Incremental Sort  (cost=15421.17..15432.66 rows=74 width=26) (actual time=172.520..180.164 rows=50 loops=1)"
"        Output: d.year, c.country, (sum(f.revenue))"
"        Sort Key: d.year, (sum(f.revenue)) DESC"
"        Presorted Key: d.year"
"        Full-sort Groups: 1  Sort Method: quicksort  Average Memory: 29kB  Peak Memory: 29kB"
"        Buffers: shared hit=6260"
"        ->  Finalize GroupAggregate  (cost=15410.65..15429.77 rows=74 width=26) (actual time=172.351..180.114 rows=59 loops=1)"
"              Output: d.year, c.country, sum(f.revenue)"
"              Group Key: d.year, c.country"
"              Buffers: shared hit=6260"
"              ->  Gather Merge  (cost=15410.65..15427.92 rows=148 width=26) (actual time=172.338..180.062 rows=160 loops=1)"
"                    Output: d.year, c.country, (PARTIAL sum(f.revenue))"
"                    Workers Planned: 2"
"                    Workers Launched: 2"
"                    Buffers: shared hit=6260"
"                    ->  Sort  (cost=14410.62..14410.81 rows=74 width=26) (actual time=117.152..117.159 rows=53 loops=3)"
"                          Output: d.year, c.country, (PARTIAL sum(f.revenue))"
"                          Sort Key: d.year, c.country"
"                          Sort Method: quicksort  Memory: 27kB"
"                          Buffers: shared hit=6260"
"                          Worker 0:  actual time=84.682..84.688 rows=52 loops=1"
"                            Sort Method: quicksort  Memory: 27kB"
"                            Buffers: shared hit=1935"
"                          Worker 1:  actual time=95.987..95.994 rows=51 loops=1"
"                            Sort Method: quicksort  Memory: 27kB"
"                            Buffers: shared hit=1943"
"                          ->  Partial HashAggregate  (cost=14407.59..14408.33 rows=74 width=26) (actual time=116.993..117.004 rows=53 loops=3)"
"                                Output: d.year, c.country, PARTIAL sum(f.revenue)"
"                                Group Key: d.year, c.country"
"                                Batches: 1  Memory Usage: 24kB"
"                                Buffers: shared hit=6230"
"                                Worker 0:  actual time=84.543..84.553 rows=52 loops=1"
"                                  Batches: 1  Memory Usage: 24kB"
"                                  Buffers: shared hit=1920"
"                                Worker 1:  actual time=95.849..95.859 rows=51 loops=1"
"                                  Batches: 1  Memory Usage: 24kB"
"                                  Buffers: shared hit=1928"
"                                ->  Hash Join  (cost=135.23..13171.86 rows=164763 width=26) (actual time=3.065..86.636 rows=132226 loops=3)"
"                                      Output: d.year, c.country, f.revenue"
"                                      Hash Cond: (f.date_id = d.date_id)"
"                                      Buffers: shared hit=6230"
"                                      Worker 0:  actual time=3.811..62.741 rows=124455 loops=1"
"                                        Buffers: shared hit=1920"
"                                      Worker 1:  actual time=3.383..71.063 rows=123984 loops=1"
"                                        Buffers: shared hit=1928"
"                                      ->  Hash Join  (cost=126.37..10897.51 rows=164763 width=26) (actual time=2.283..62.143 rows=132226 loops=3)"
"                                            Output: f.revenue, f.date_id, c.country"
"                                            Hash Cond: (f.customer_id = c.customer_id)"
"                                            Buffers: shared hit=6194"
"                                            Worker 0:  actual time=2.821..45.117 rows=124455 loops=1"
"                                              Buffers: shared hit=1903"
"                                            Worker 1:  actual time=2.235..51.114 rows=123984 loops=1"
"                                              Buffers: shared hit=1911"
"                                            ->  Parallel Seq Scan on public.fact_sales f  (cost=0.00..8293.46 rows=221346 width=20) (actual time=0.022..14.157 rows=177075 loops=3)"
"                                                  Output: f.invoice_no, f.product_id, f.customer_id, f.date_id, f.quantity, f.unit_price, f.revenue, f.is_return, f.is_free_item"
"                                                  Buffers: shared hit=6080"
"                                                  Worker 0:  actual time=0.022..10.768 rows=162538 loops=1"
"                                                    Buffers: shared hit=1860"
"                                                  Worker 1:  actual time=0.034..12.230 rows=162418 loops=1"
"                                                    Buffers: shared hit=1868"
"                                            ->  Hash  (cost=71.72..71.72 rows=4372 width=22) (actual time=2.071..2.072 rows=4372 loops=3)"
"                                                  Output: c.country, c.customer_id"
"                                                  Buckets: 8192  Batches: 1  Memory Usage: 301kB"
"                                                  Buffers: shared hit=84"
"                                                  Worker 0:  actual time=2.566..2.566 rows=4372 loops=1"
"                                                    Buffers: shared hit=28"
"                                                  Worker 1:  actual time=1.916..1.918 rows=4372 loops=1"
"                                                    Buffers: shared hit=28"
"                                                  ->  Seq Scan on dims.dim_customers c  (cost=0.00..71.72 rows=4372 width=22) (actual time=0.732..1.272 rows=4372 loops=3)"
"                                                        Output: c.country, c.customer_id"
"                                                        Buffers: shared hit=84"
"                                                        Worker 0:  actual time=1.217..1.761 rows=4372 loops=1"
"                                                          Buffers: shared hit=28"
"                                                        Worker 1:  actual time=0.963..1.373 rows=4372 loops=1"
"                                                          Buffers: shared hit=28"
"                                      ->  Hash  (cost=5.05..5.05 rows=305 width=8) (actual time=0.747..0.748 rows=305 loops=3)"
"                                            Output: d.year, d.date_id"
"                                            Buckets: 1024  Batches: 1  Memory Usage: 20kB"
"                                            Buffers: shared hit=6"
"                                            Worker 0:  actual time=0.954..0.955 rows=305 loops=1"
"                                              Buffers: shared hit=2"
"                                            Worker 1:  actual time=1.105..1.107 rows=305 loops=1"
"                                              Buffers: shared hit=2"
"                                            ->  Seq Scan on dims.dim_date d  (cost=0.00..5.05 rows=305 width=8) (actual time=0.649..0.687 rows=305 loops=3)"
"                                                  Output: d.year, d.date_id"
"                                                  Buffers: shared hit=6"
"                                                  Worker 0:  actual time=0.868..0.895 rows=305 loops=1"
"                                                    Buffers: shared hit=2"
"                                                  Worker 1:  actual time=1.018..1.051 rows=305 loops=1"
"                                                    Buffers: shared hit=2"
"Planning:"
"  Buffers: shared hit=16"
"Planning Time: 0.778 ms"
"Execution Time: 180.353 ms"
